# https://esham.io/2018/02/zsh-profiling

# zmodload zsh/zprof
# zmodload zsh/datetime
# setopt PROMPT_SUBST
# PS4='+$EPOCHREALTIME %N:%i> '
# logfile=$(mktemp zsh_profile.XXXXXXXX)
# echo "Logging to $logfile"
# exec 3>&2 2>$logfile
# setopt XTRACE

# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "$HOME/.cache/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "$HOME/.cache/p10k-instant-prompt-${(%):-%n}.zsh"
fi

if [[ ! -d ~/.zinit ]]; then
  mkdir -p ~/.zinit && \
    git clone --depth 1 \
      https://github.com/zdharma/zinit.git \
      ~/.zinit/bin
fi

source ~/.zinit/bin/zinit.zsh

zinit depth"1" light-mode for \
  @romkatv/powerlevel10k

# Load p10k config
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

zinit depth"1" light-mode for \
  @wfxr/forgit \
  @thetic/extract \
  @MichaelAquilina/zsh-you-should-use \
  @MichaelAquilina/zsh-auto-notify \
  @PZTM::gnu-utility \
  @PZTM::history \
  @PZTM::directory \
  @agkozak/zsh-z \
  as"program" pick"bin/git-dsf" \
    @zdharma/zsh-diff-so-fancy \
  src:'shell/key-bindings.zsh' \
    @junegunn/fzf \
  @Aloxaf/fzf-tab \
  has'docker' as"completion" is-snippet \
    @https://github.com/docker/cli/blob/master/contrib/completion/zsh/_docker \
  @zdharma/fast-syntax-highlighting \
  blockf atpull'zinit creinstall -q .' \
    @zsh-users/zsh-completions

source $HOME/.shell/.options # shell options
source $HOME/.shell/.exports # environmental veriables
source $HOME/.shell/.completions # completion config
source $HOME/.shell/.history  # zsh history config
source $HOME/.shell_env # aliases, functions, externals

# unsetopt XTRACE
# exec 2>&3 3>&-
